---
import { Icon } from 'astro-icon/components';
import { t } from '../i18n/index';
import type { Locale } from '../i18n/config';

interface Props {
  lang?: Locale;
}

const { lang = 'en' } = Astro.props;
const i = t(lang);
const prefix = lang === 'fr' ? '/fr' : '';

const currentYear = new Date().getFullYear();

const footerLinks = {
  services: [
    { href: `${prefix}/services#massage`, label: i.footer.massageRelaxation },
    { href: `${prefix}/services#wet-spa`, label: i.footer.wetSpaHydro },
    { href: `${prefix}/services#face-care`, label: i.footer.faceCare },
    { href: `${prefix}/services#haircuts`, label: i.footer.haircutsStyling },
    { href: `${prefix}/services#coloring`, label: i.footer.hairColoring },
    { href: `${prefix}/services#braiding`, label: i.footer.braidingLocs },
    { href: `${prefix}/services#shaves`, label: i.footer.shavingBeard },
    { href: `${prefix}/services#nails`, label: i.footer.manicurePedicure },
  ],
  products: [
    { href: `${prefix}/products/beard-oil`, label: i.footer.beardOil },
    { href: `${prefix}/products/face-serum`, label: i.footer.faceSerum },
    { href: `${prefix}/products/shea-butter`, label: i.footer.bodyButter },
    { href: `${prefix}/products/hair-oil`, label: i.footer.hairOil },
    { href: `${prefix}/products`, label: i.footer.allProducts },
  ],
  company: [
    { href: `${prefix}/about`, label: i.footer.ourStory },
    { href: `${prefix}/gallery`, label: i.footer.galleryLink },
    { href: `${prefix}/contact`, label: i.footer.contactLink },
  ],
  support: [
    { href: '#booking-modal', label: i.footer.bookAppointment },
    { href: `${prefix}/services`, label: i.footer.allServices },
    { href: `${prefix}/faq`, label: i.footer.faq },
  ],
};

const socialLinks = [
  { href: 'https://web.facebook.com/ultimatebeauty0', label: 'Facebook', icon: 'M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z' },
  { href: 'https://www.tiktok.com/@ultimatebeautysalon', label: 'TikTok', icon: 'M16.6 5.82s.51.5 0 0A4.278 4.278 0 0 1 15.54 3h-3.09v12.4a2.592 2.592 0 0 1-2.59 2.5c-1.42 0-2.6-1.16-2.6-2.6 0-1.72 1.66-3.01 3.37-2.48V9.66c-3.45-.46-6.47 2.22-6.47 5.64 0 3.33 2.76 5.7 5.69 5.7 3.14 0 5.69-2.55 5.69-5.7V9.01a7.35 7.35 0 0 0 4.3 1.38V7.3s-1.88.09-3.24-1.48z' },
  { href: 'https://www.snapchat.com/add/ultimatebeauty3', label: 'Snapchat', icon: 'M12.166 3c1.38 0 2.873.56 3.817 1.81.682.905.886 2.088.803 3.698l-.005.092c-.022.442-.044.89-.003 1.119.038.215.155.396.277.475.353.228.749.397 1.108.549l.117.05c.464.2.864.384 1.072.563.37.319.365.693.236.972-.204.44-.693.73-1.432.847a2.198 2.198 0 0 0-.378.09c-.123.053-.16.1-.191.17-.064.141-.072.305-.08.448l-.002.052c-.021.438-.07.899-.61 1.165-.24.118-.545.18-.922.254l-.095.019c-.303.06-.646.128-.938.24-.295.112-.489.253-.792.531l-.087.08c-.6.554-1.231 1.096-2.168 1.096-.019 0-.037 0-.056-.002a1.16 1.16 0 0 1-.056.002c-.937 0-1.568-.542-2.168-1.096l-.087-.08c-.303-.278-.497-.419-.792-.531-.292-.112-.636-.18-.938-.24l-.095-.019c-.377-.074-.682-.136-.922-.254-.54-.266-.59-.727-.61-1.165l-.002-.052c-.008-.143-.016-.307-.08-.448-.031-.07-.068-.117-.19-.17a2.204 2.204 0 0 0-.379-.09c-.739-.117-1.228-.407-1.432-.847-.129-.28-.134-.653.236-.972.208-.179.608-.363 1.072-.563l.117-.05c.36-.152.755-.321 1.108-.549.122-.079.24-.26.277-.475.041-.23.019-.677-.003-1.119l-.005-.092c-.083-1.61.121-2.793.803-3.698C9.294 3.56 10.786 3 12.166 3z' },
  { href: 'https://www.pinterest.com/ultimatebeautysalon', label: 'Pinterest', icon: 'M12 2C6.477 2 2 6.477 2 12c0 4.236 2.636 7.855 6.356 9.312-.088-.791-.167-2.005.035-2.868.181-.78 1.172-4.97 1.172-4.97s-.299-.598-.299-1.482c0-1.388.806-2.425 1.808-2.425.853 0 1.265.64 1.265 1.408 0 .858-.546 2.14-.828 3.33-.236.995.5 1.807 1.482 1.807 1.778 0 3.144-1.874 3.144-4.58 0-2.393-1.72-4.068-4.177-4.068-2.845 0-4.515 2.135-4.515 4.34 0 .859.331 1.781.745 2.282a.3.3 0 0 1 .069.288l-.278 1.133c-.044.183-.145.222-.335.134-1.249-.581-2.03-2.407-2.03-3.874 0-3.154 2.292-6.052 6.608-6.052 3.469 0 6.165 2.473 6.165 5.776 0 3.447-2.173 6.22-5.19 6.22-1.013 0-1.965-.527-2.291-1.148l-.623 2.378c-.226.869-.835 1.958-1.244 2.621.937.29 1.931.446 2.962.446 5.523 0 10-4.477 10-10S17.523 2 12 2z' },
];

const address = lang === 'fr'
  ? 'Avant Saint James hôtel, Bonamoussadi, Douala, Cameroun'
  : 'Avant Saint James hotel, Bonamoussadi, Douala, Cameroon';
const hours = lang === 'fr' ? 'Ouvert tous les jours : 9h — 21h' : 'Open Daily: 9 AM — 9 PM';
---

<footer class="ft" role="contentinfo">
  <!-- ── Light Hero Zone: Brand + Newsletter ── -->
  <div class="ft-hero-wrap">
    <div class="container">
      <div class="ft-hero">
      <div class="ft-hero__brand">
        <a href={`${prefix}/`} class="ft-logo" aria-label="Ultimate Beauty Spa">
          <img src="/images/logo.svg" alt="" class="ft-logo__img" />
        </a>
        <p class="ft-hero__desc">{i.footer.brandDesc}</p>

        <!-- Social Icons -->
        <div class="ft-socials">
          {socialLinks.map(s => (
            <a
              href={s.href}
              target="_blank"
              rel="noopener noreferrer"
              class="ft-social"
              aria-label={`${s.label}`}
              title={s.label}
            >
              <svg width="15" height="15" viewBox="0 0 24 24" fill="currentColor">
                <path d={s.icon} />
              </svg>
            </a>
          ))}
        </div>
      </div>

      <div class="ft-hero__cta">
        <div class="ft-newsletter">
          <span class="ft-newsletter__badge">
            <Icon name="lucide:sparkles" class="w-3 h-3" />
            <span>{i.footer.stayUpdated}</span>
          </span>
          <h3 class="ft-newsletter__title">{i.footer.getOffers}</h3>
          <form class="ft-form" id="newsletter-form">
            <div class="ft-form__wrap">
              <input
                type="email"
                name="email"
                placeholder={i.footer.emailPlaceholder}
                required
                class="ft-form__input"
                aria-label="Email for newsletter"
              />
              <button type="submit" class="ft-form__btn">
                <Icon name="lucide:arrow-right" class="w-4 h-4" />
              </button>
            </div>
            <p class="ft-form__msg" id="newsletter-msg" style="display:none; margin-top: 0.5rem; font-size: 0.8125rem;"></p>
          </form>
        </div>
      </div>
    </div>
    </div>
  </div>

  <!-- ── Dark Section ── -->
  <div class="ft-dark">
    <div class="ft-ambient"></div>
    <div class="container relative z-10">

    <!-- ── Link Columns ── -->
    <div class="ft-cols">
      <!-- Services -->
      <div class="ft-col">
        <h4 class="ft-col__heading">{i.footer.servicesTitle}</h4>
        <ul class="ft-col__list">
          {footerLinks.services.map(link => (
            <li><a href={link.href}>{link.label}</a></li>
          ))}
        </ul>
      </div>

      <!-- Products -->
      <div class="ft-col">
        <h4 class="ft-col__heading">{i.footer.productsTitle}</h4>
        <ul class="ft-col__list">
          {footerLinks.products.map(link => (
            <li><a href={link.href}>{link.label}</a></li>
          ))}
        </ul>
      </div>

      <!-- Company + Support -->
      <div class="ft-col">
        <h4 class="ft-col__heading">{i.footer.companyTitle}</h4>
        <ul class="ft-col__list">
          {footerLinks.company.map(link => (
            <li><a href={link.href}>{link.label}</a></li>
          ))}
        </ul>
        <h4 class="ft-col__heading ft-col__heading--mt">{i.footer.supportTitle}</h4>
        <ul class="ft-col__list">
          {footerLinks.support.map(link => (
            <li><a href={link.href} data-booking-modal={link.href === '#booking-modal' ? '' : undefined}>{link.label}</a></li>
          ))}
        </ul>
      </div>

      <!-- Contact Card -->
      <div class="ft-col ft-col--contact">
        <h4 class="ft-col__heading">{i.footer.contactTitle}</h4>
        <div class="ft-contact-card">
          <ul class="ft-contact">
            <li>
              <span class="ft-contact__dot"></span>
              <span>{address}</span>
            </li>
            <li>
              <span class="ft-contact__dot"></span>
              <a href="tel:+237697113339">+237 697 113 339</a>
            </li>
            <li>
              <span class="ft-contact__dot"></span>
              <a href="mailto:hello@ultimatebeautyspa.net">hello@ultimatebeautyspa.net</a>
            </li>
            <li>
              <span class="ft-contact__dot ft-contact__dot--live"></span>
              <span>{hours}</span>
            </li>
          </ul>

          <a href="#booking-modal" data-booking-modal class="ft-book">
            <span>{i.footer.bookAppointment}</span>
            <Icon name="lucide:arrow-up-right" class="w-4 h-4" />
          </a>
        </div>
      </div>
    </div>
    </div>
  </div>

  <!-- ── Bottom Bar ── -->
  <div class="ft-bottom">
    <div class="container">
      <div class="ft-bottom__row">
        <p class="ft-bottom__copy">
          &copy; {currentYear} Ultimate Beauty Spa. {lang === 'fr' ? 'Tous droits réservés.' : 'All rights reserved.'}
        </p>
        <nav class="ft-bottom__legal" aria-label="Legal links">
          <a href={`${prefix}/privacy`}>{i.footer.privacyPolicy}</a>
          <a href={`${prefix}/terms`}>{i.footer.termsOfService}</a>
          <a href={`${prefix}/accessibility`}>{i.footer.accessibility}</a>
          <a href={`${prefix}/cookies`}>{i.footer.cookiesPolicy}</a>
        </nav>
      </div>
      <p class="ft-bottom__credit">
        {i.footer.designedBy} <a href="https://bigtee.dev" target="_blank" rel="noopener noreferrer">bigtee.dev</a>
      </p>
    </div>
  </div>
</footer>

<script>
  const nlForm = document.getElementById('newsletter-form') as HTMLFormElement | null;
  const nlMsg = document.getElementById('newsletter-msg');

  nlForm?.addEventListener('submit', async (e) => {
    e.preventDefault();
    if (!nlForm || !nlMsg) return;

    const email = (nlForm.querySelector('input[name="email"]') as HTMLInputElement)?.value;
    if (!email) return;

    const btn = nlForm.querySelector('button[type="submit"]') as HTMLButtonElement | null;
    if (btn) { btn.disabled = true; btn.style.opacity = '0.5'; }

    try {
      const res = await fetch('/api/send-email', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ type: 'newsletter', email }),
      });

      nlMsg.style.display = 'block';
      if (res.ok) {
        nlMsg.textContent = 'Thank you for subscribing! ✨';
        nlMsg.style.color = '#22c55e';
        nlForm.reset();
      } else {
        nlMsg.textContent = 'Something went wrong. Please try again.';
        nlMsg.style.color = '#ef4444';
      }
    } catch {
      nlMsg.style.display = 'block';
      nlMsg.textContent = 'Network error. Please try again.';
      nlMsg.style.color = '#ef4444';
    } finally {
      if (btn) { btn.disabled = false; btn.style.opacity = '1'; }
    }
  });
</script>

<style>
  /* ═══════════════════════════════════════════
     FOOTER — Refined Dark Canvas
     ═══════════════════════════════════════════ */

  .ft {
    position: relative;
    overflow: hidden;
  }

  /* ── Light Hero Wrapper ── */
  .ft-hero-wrap {
    background: var(--color-snow);
  }

  /* ── Dark Section ── */
  .ft-dark {
    position: relative;
    background: var(--color-black);
  }

  /* Ambient gradient backdrop (inside dark section) */
  .ft-ambient {
    position: absolute;
    inset: 0;
    background:
      radial-gradient(ellipse 900px 350px at 20% 0%, rgba(225,29,72,0.06) 0%, transparent 70%),
      radial-gradient(ellipse 600px 500px at 85% 100%, rgba(225,29,72,0.04) 0%, transparent 60%);
    pointer-events: none;
  }

  /* ── Hero Zone (light) ── */
  .ft-hero {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 4rem;
    padding: 5rem 0 4rem;
  }

  .ft-hero__brand {
    max-width: 360px;
    flex-shrink: 0;
  }

  .ft-logo {
    display: inline-block;
    margin-bottom: 1.25rem;
  }

  .ft-logo__img {
    height: 52px;
    width: auto;
    transition: opacity 0.3s ease;
  }

  .ft-logo:hover .ft-logo__img {
    opacity: 0.7;
  }

  .ft-hero__desc {
    font-size: 0.9375rem;
    color: var(--color-gray);
    line-height: 1.75;
    margin-bottom: 1.5rem;
  }

  /* Socials (light bg) */
  .ft-socials {
    display: flex;
    gap: 0.375rem;
  }

  .ft-social {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 34px;
    height: 34px;
    border-radius: 10px;
    background: var(--color-charcoal);
    color: rgba(255,255,255,0.85);
    transition: all 0.35s var(--ease-out-expo);
  }

  .ft-social:hover {
    background: var(--color-red);
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(225,29,72,0.3);
  }

  /* Newsletter (dark card on light bg) */
  .ft-hero__cta {
    max-width: 400px;
    flex-shrink: 0;
  }

  .ft-newsletter {
    background: var(--color-onyx);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 20px;
    padding: 2rem;
  }

  .ft-newsletter__badge {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.25rem 0.75rem;
    font-size: 0.6875rem;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--color-red-light);
    background: rgba(225,29,72,0.12);
    border: 1px solid rgba(225,29,72,0.15);
    border-radius: 100px;
    margin-bottom: 1rem;
  }

  .ft-newsletter__title {
    font-size: 1.125rem;
    font-weight: 700;
    color: white;
    line-height: 1.4;
    margin-bottom: 1.25rem;
    letter-spacing: -0.01em;
  }

  .ft-form__wrap {
    display: flex;
    align-items: center;
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 100px;
    padding: 0.25rem 0.25rem 0.25rem 1.125rem;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
  }

  .ft-form__wrap:focus-within {
    border-color: rgba(225,29,72,0.4);
    box-shadow: 0 0 0 4px rgba(225,29,72,0.08);
  }

  .ft-form__input {
    flex: 1;
    background: transparent;
    border: none;
    font-size: 0.875rem;
    color: white;
    outline: none;
    padding: 0.5rem 0;
    min-width: 0;
  }

  .ft-form__input::placeholder {
    color: rgba(255,255,255,0.3);
  }

  .ft-form__btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 38px;
    height: 38px;
    border-radius: 50%;
    background: var(--color-red);
    border: none;
    color: white;
    cursor: pointer;
    flex-shrink: 0;
    transition: all 0.35s var(--ease-out-expo);
  }

  .ft-form__btn:hover {
    background: var(--color-red-dark);
    transform: scale(1.08);
    box-shadow: 0 4px 16px rgba(225,29,72,0.35);
  }

  /* ── Link Columns ── */
  .ft-cols {
    display: grid;
    grid-template-columns: 1.4fr 1fr 1fr 1.5fr;
    gap: 2.5rem;
    padding: 3.5rem 0 4rem;
  }

  .ft-col__heading {
    font-size: 0.6875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.18em;
    color: rgba(255,255,255,0.3);
    margin-bottom: 1.25rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid rgba(255,255,255,0.05);
  }

  .ft-col__heading--mt {
    margin-top: 1.75rem;
  }

  .ft-col__list {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .ft-col__list a {
    display: inline-flex;
    align-items: center;
    font-size: 0.8125rem;
    color: rgba(255,255,255,0.5);
    text-decoration: none;
    padding: 0.25rem 0;
    transition: color 0.25s ease, transform 0.25s ease;
  }

  .ft-col__list a:hover {
    color: white;
    transform: translateX(4px);
  }

  /* Contact Card */
  .ft-contact-card {
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 16px;
    padding: 1.5rem;
  }

  .ft-contact {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.875rem;
  }

  .ft-contact li {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
  }

  .ft-contact__dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: rgba(255,255,255,0.15);
    flex-shrink: 0;
    margin-top: 0.5rem;
  }

  .ft-contact__dot--live {
    background: var(--color-red);
    box-shadow: 0 0 8px rgba(225,29,72,0.5);
    animation: ft-live 2.5s infinite;
  }

  @keyframes ft-live {
    0%, 100% { opacity: 1; }
    50%      { opacity: 0.4; }
  }

  .ft-contact span,
  .ft-contact a {
    font-size: 0.8125rem;
    color: rgba(255,255,255,0.5);
    text-decoration: none;
    line-height: 1.5;
  }

  .ft-contact a:hover {
    color: white;
  }

  .ft-book {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 1.25rem;
    padding: 0.75rem 1.25rem;
    background: var(--color-red);
    color: white;
    font-size: 0.8125rem;
    font-weight: 600;
    text-decoration: none;
    border-radius: 100px;
    transition: all 0.35s var(--ease-out-expo);
    letter-spacing: 0.02em;
  }

  .ft-book:hover {
    background: var(--color-red-dark);
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(225,29,72,0.3);
  }

  /* ── Bottom Bar ── */
  .ft-bottom {
    background: var(--color-black);
    border-top: 1px solid rgba(255,255,255,0.05);
    padding: 1.5rem 0 1.25rem;
  }

  .ft-bottom__row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 2rem;
    flex-wrap: wrap;
  }

  .ft-bottom__copy {
    font-size: 0.75rem;
    color: rgba(255,255,255,0.25);
  }

  .ft-bottom__legal {
    display: flex;
    align-items: center;
    gap: 1.25rem;
    flex-wrap: wrap;
  }

  .ft-bottom__legal a {
    font-size: 0.75rem;
    color: rgba(255,255,255,0.25);
    text-decoration: none;
    transition: color 0.25s ease;
  }

  .ft-bottom__legal a:hover {
    color: rgba(255,255,255,0.65);
  }

  .ft-bottom__credit {
    text-align: center;
    padding-top: 0.875rem;
    margin-top: 0.875rem;
    border-top: 1px solid rgba(255,255,255,0.04);
    font-size: 0.6875rem;
    color: rgba(255,255,255,0.2);
  }

  .ft-bottom__credit a {
    color: rgba(255,255,255,0.35);
    text-decoration: none;
    font-weight: 600;
    transition: color 0.25s ease;
  }

  .ft-bottom__credit a:hover {
    color: var(--color-red);
  }

  /* ── Responsive ── */
  @media (max-width: 1024px) {
    .ft-hero {
      flex-direction: column;
      gap: 2.5rem;
    }

    .ft-hero__brand,
    .ft-hero__cta {
      max-width: 100%;
    }

    .ft-cols {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 640px) {
    .ft-hero {
      padding: 3.5rem 0 2.5rem;
    }

    .ft-newsletter {
      padding: 1.5rem;
    }

    .ft-cols {
      grid-template-columns: 1fr;
      gap: 2rem;
      padding: 2.5rem 0 3rem;
    }

    .ft-bottom__row {
      flex-direction: column;
      text-align: center;
    }

    .ft-bottom__legal {
      justify-content: center;
    }

    .ft-logo__img {
      height: 44px;
    }
  }
</style>
