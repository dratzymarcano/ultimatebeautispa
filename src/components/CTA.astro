---
import { Icon } from 'astro-icon/components';
import { t } from '../i18n/index';
import type { Locale } from '../i18n/config';

interface Props {
  lang?: Locale;
  title?: string;
  subtitle?: string;
  primaryCta?: { text: string; href: string };
  secondaryCta?: { text: string; href: string };
}

const {
  lang = 'en',
  title,
  subtitle,
  primaryCta,
  secondaryCta
} = Astro.props;
const i = t(lang);
const prefix = lang === 'fr' ? '/fr' : '';

const ctaTitle = title ?? i.cta.title;
const ctaSubtitle = subtitle ?? i.cta.subtitle;
const ctaPrimary = primaryCta ?? { text: i.cta.ctaPrimary, href: prefix + '/book' };
const ctaSecondary = secondaryCta ?? { text: i.cta.ctaSecondary, href: prefix + '/services' };

const highlights = [
  { icon: 'lucide:sparkles', text: lang === 'fr' ? 'Soins Premium' : 'Premium Care' },
  { icon: 'lucide:clock', text: lang === 'fr' ? 'Ouvert 7j/7' : 'Open Every Day' },
  { icon: 'lucide:award', text: lang === 'fr' ? 'Ã‰quipe Experte' : 'Expert Team' },
  { icon: 'lucide:heart', text: lang === 'fr' ? '2 000+ Clients' : '2,000+ Clients' },
];
---

<section class="ub-cta" id="cta">
  <div class="ub-cta__bg" aria-hidden="true">
    <div class="ub-cta__gradient"></div>
    <div class="ub-cta__shape ub-cta__shape--1"></div>
    <div class="ub-cta__shape ub-cta__shape--2"></div>
    <div class="ub-cta__noise"></div>
  </div>

  <div class="ub-cta__container">
    <div class="ub-cta__content">
      <div class="ub-cta__eyebrow">
        <span class="ub-cta__eyebrow-line"></span>
        <span class="ub-cta__eyebrow-text">{lang === 'fr' ? 'Votre Moment' : 'Your Moment'}</span>
        <span class="ub-cta__eyebrow-line"></span>
      </div>

      <h2 class="ub-cta__title">{ctaTitle}</h2>
      <p class="ub-cta__subtitle">{ctaSubtitle}</p>

      <div class="ub-cta__highlights">
        {highlights.map((h) => (
          <div class="ub-cta__highlight">
            <Icon name={h.icon} class="w-5 h-5" />
            <span>{h.text}</span>
          </div>
        ))}
      </div>

      <div class="ub-cta__actions">
        <a href={ctaPrimary.href} class="ub-cta__btn-primary">
          <span>{ctaPrimary.text}</span>
          <Icon name="lucide:arrow-up-right" class="w-4 h-4" />
        </a>
        <a href={ctaSecondary.href} class="ub-cta__btn-secondary">
          <span>{ctaSecondary.text}</span>
        </a>
      </div>

      <p class="ub-cta__note">{i.cta.note}</p>
    </div>
  </div>
</section>

<style>
  .ub-cta {
    position: relative;
    padding: clamp(5rem, 10vw, 9rem) 0;
    overflow: hidden;
    background: var(--color-black);
  }

  .ub-cta__bg { position: absolute; inset: 0; pointer-events: none; }

  .ub-cta__gradient {
    position: absolute; inset: 0;
    background:
      radial-gradient(ellipse 60% 50% at 50% 0%, rgba(225,29,72,0.1), transparent),
      radial-gradient(ellipse 40% 60% at 80% 100%, rgba(251,113,133,0.06), transparent);
  }

  .ub-cta__shape {
    position: absolute; border-radius: 50%; filter: blur(100px);
    mix-blend-mode: screen; pointer-events: none;
  }

  .ub-cta__shape--1 {
    width: 500px; height: 500px;
    background: rgba(225,29,72,0.08);
    top: -20%; left: -10%;
    animation: ub-cta-float 20s ease-in-out infinite;
  }

  .ub-cta__shape--2 {
    width: 300px; height: 300px;
    background: rgba(251,113,133,0.06);
    bottom: -10%; right: -5%;
    animation: ub-cta-float 16s ease-in-out infinite 5s;
  }

  @keyframes ub-cta-float {
    0%, 100% { transform: translate(0, 0); }
    50% { transform: translate(20px, -15px); }
  }

  .ub-cta__noise {
    position: absolute; inset: 0; opacity: 0.03;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.08'/%3E%3C/svg%3E");
    mix-blend-mode: overlay;
  }

  .ub-cta__container {
    position: relative; z-index: 2;
    max-width: 800px; margin: 0 auto;
    padding: 0 clamp(1.5rem, 5vw, 4rem);
    text-align: center;
  }

  .ub-cta__content {
    display: flex; flex-direction: column;
    align-items: center; gap: 1.5rem;
  }

  .ub-cta__eyebrow {
    display: flex; align-items: center; gap: 1rem;
  }

  .ub-cta__eyebrow-line {
    width: 40px; height: 1px; background: rgba(255,255,255,0.15);
  }

  .ub-cta__eyebrow-text {
    font-size: 0.6875rem; font-weight: 700;
    letter-spacing: 0.25em; text-transform: uppercase;
    color: var(--color-red-light);
  }

  .ub-cta__title {
    font-size: clamp(2.5rem, 5.5vw, 4rem); font-weight: 800;
    line-height: 1.1; letter-spacing: -0.03em;
    color: var(--color-white); margin: 0;
    max-width: 650px;
  }

  .ub-cta__subtitle {
    font-size: clamp(1rem, 1.2vw, 1.125rem); line-height: 1.7;
    color: rgba(255,255,255,0.5); max-width: 540px; margin: 0;
  }

  .ub-cta__highlights {
    display: flex; flex-wrap: wrap;
    justify-content: center; gap: 0.75rem;
    margin-top: 0.5rem;
  }

  .ub-cta__highlight {
    display: flex; align-items: center; gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 100px;
    font-size: 0.8125rem; font-weight: 500;
    color: rgba(255,255,255,0.6);
    transition: all 0.3s var(--ease-out-expo);
  }

  .ub-cta__highlight:hover {
    background: rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.8);
  }

  .ub-cta__highlight [data-icon] { color: var(--color-red); }

  .ub-cta__actions {
    display: flex; flex-wrap: wrap;
    justify-content: center; gap: 1rem;
    margin-top: 0.5rem;
  }

  .ub-cta__btn-primary {
    display: inline-flex; align-items: center; gap: 0.625rem;
    padding: 1rem 2.25rem; background: var(--color-red);
    color: var(--color-white); font-weight: 650; font-size: 0.9375rem;
    border-radius: 100px; text-decoration: none;
    position: relative; overflow: hidden;
    transition: all 0.4s var(--ease-out-expo);
    box-shadow: 0 0 0 0 rgba(225,29,72,0.4);
  }

  .ub-cta__btn-primary::before {
    content: ''; position: absolute; inset: 0;
    background: linear-gradient(135deg, var(--color-red-bright), var(--color-red-dark));
    opacity: 0; transition: opacity 0.4s; border-radius: inherit;
  }

  .ub-cta__btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 40px -8px rgba(225,29,72,0.5);
  }
  .ub-cta__btn-primary:hover::before { opacity: 1; }
  .ub-cta__btn-primary span, .ub-cta__btn-primary [data-icon] { position: relative; z-index: 1; }

  .ub-cta__btn-secondary {
    display: inline-flex; align-items: center; gap: 0.5rem;
    padding: 1rem 2rem; color: rgba(255,255,255,0.6);
    font-weight: 600; font-size: 0.9375rem; text-decoration: none;
    border: 1px solid rgba(255,255,255,0.12); border-radius: 100px;
    transition: all 0.3s var(--ease-out-expo);
  }

  .ub-cta__btn-secondary:hover {
    color: var(--color-white);
    border-color: rgba(255,255,255,0.25);
    background: rgba(255,255,255,0.04);
  }

  .ub-cta__note {
    font-size: 0.8125rem; color: rgba(255,255,255,0.3);
    margin: 0; max-width: 400px;
  }

  @media (max-width: 640px) {
    .ub-cta__actions { flex-direction: column; width: 100%; }
    .ub-cta__btn-primary, .ub-cta__btn-secondary { width: 100%; justify-content: center; }
    .ub-cta__highlights { gap: 0.5rem; }
    .ub-cta__highlight { font-size: 0.75rem; padding: 0.4rem 0.75rem; }
  }

  @media (prefers-reduced-motion: reduce) {
    .ub-cta__shape { animation: none; }
  }
</style>