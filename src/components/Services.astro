---
import { Icon } from 'astro-icon/components';

interface Service {
  id: string;
  title: string;
  description: string;
  price: string;
  duration: string;
  image: string;
  featured?: boolean;
  icon: string;
}

interface Props {
  title?: string;
  subtitle?: string;
  showAll?: boolean;
}

const { 
  title = "Our Services",
  subtitle = "Curated experiences designed for the discerning individual",
  showAll = false 
} = Astro.props;

const services: Service[] = [
  {
    id: 'haircuts',
    title: 'Haircuts & Styling',
    description: 'Precision cuts tailored to your unique features. Our master stylists blend classic techniques with modern trends.',
    price: 'À partir de 35 000 XAF',
    duration: '45–60 min',
    image: 'https://images.unsplash.com/photo-1503951914875-452162b0f3f1?w=600&h=700&fit=crop&q=80',
    featured: true,
    icon: 'lucide:scissors'
  },
  {
    id: 'shaves',
    title: 'Traditional Shaves',
    description: 'The timeless ritual of a straight razor shave with hot towels and premium oils.',
    price: 'À partir de 30 000 XAF',
    duration: '30–45 min',
    image: 'https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=600&h=700&fit=crop&q=80',
    featured: true,
    icon: 'lucide:blend'
  },
  {
    id: 'massage',
    title: 'Massage Therapy',
    description: 'Restore balance with therapeutic touch — deep tissue, hot stone, relaxation.',
    price: 'À partir de 50 000 XAF',
    duration: '60–90 min',
    image: 'https://images.unsplash.com/photo-1544161515-4ab6ce6db874?w=600&h=700&fit=crop&q=80',
    featured: true,
    icon: 'lucide:heart-handshake'
  },
  {
    id: 'tattoo',
    title: 'Tattoo Artistry',
    description: 'Custom artwork that tells your story, crafted by award-winning tattoo artists.',
    price: 'Consultation gratuite',
    duration: 'Variable',
    image: 'https://images.unsplash.com/photo-1598371839696-5c5bb00bdc28?w=600&h=700&fit=crop&q=80',
    featured: true,
    icon: 'lucide:pen-tool'
  },
  {
    id: 'skincare',
    title: 'Skincare Treatments',
    description: 'Advanced facials and skin treatments. Combat aging with science-backed solutions.',
    price: 'À partir de 45 000 XAF',
    duration: '45–75 min',
    image: 'https://images.unsplash.com/photo-1570172619644-dfd03ed5d881?w=600&h=700&fit=crop&q=80',
    featured: true,
    icon: 'lucide:sparkles'
  },
  {
    id: 'braiding',
    title: 'Hair Braiding',
    description: 'Expert braiding, locs, twists — achieve your desired look with precision craftsmanship.',
    price: 'À partir de 40 000 XAF',
    duration: '60–180 min',
    image: 'https://images.unsplash.com/photo-1522337360788-8b13dee7a37e?w=600&h=700&fit=crop&q=80',
    featured: true,
    icon: 'lucide:ribbon'
  }
];

const displayServices = showAll ? services : services.filter(s => s.featured);
---

<section class="services-section" id="services">
  <div class="container">
    <!-- Header -->
    <header class="services-header">
      <div class="header-eyebrow">
        <span class="eyebrow-line"></span>
        <span class="eyebrow-text">What We Offer</span>
      </div>

      <div class="header-row">
        <h2 class="services-title">{title}</h2>
        <p class="services-subtitle">{subtitle}</p>
      </div>
    </header>

    <!-- Services Grid -->
    <div class="services-grid">
      {displayServices.map((service, index) => (
        <article class="service-card" style={`--i:${index}`}>
          <a href={`/services#${service.id}`} class="card-link">
            <!-- Image -->
            <div class="card-image">
              <img
                src={service.image}
                alt={service.title}
                loading="lazy"
                width="600"
                height="700"
              />
              <div class="card-image-overlay"></div>

              <!-- Price Tag (on image) -->
              <div class="card-price-tag">
                <span>{service.price}</span>
              </div>
            </div>

            <!-- Content -->
            <div class="card-content">
              <div class="card-icon">
                <Icon name={service.icon} size={22} />
              </div>

              <h3 class="card-title">{service.title}</h3>
              <p class="card-desc">{service.description}</p>

              <div class="card-footer">
                <span class="card-duration">
                  <Icon name="lucide:clock" size={14} />
                  {service.duration}
                </span>
                <span class="card-arrow">
                  <Icon name="lucide:arrow-up-right" size={18} />
                </span>
              </div>
            </div>
          </a>
        </article>
      ))}
    </div>

    <!-- CTA -->
    {!showAll && (
      <div class="services-cta">
        <a href="/services" class="btn-secondary">
          <span>View All Services & Pricing</span>
          <Icon name="lucide:arrow-up-right" size={16} />
        </a>
      </div>
    )}
  </div>
</section>

<style>
  .services-section {
    padding: clamp(4rem, 8vw, 8rem) 0;
    background: var(--color-white);
    overflow: hidden;
  }

  /* ============================================
     HEADER
     ============================================ */
  .services-header {
    margin-bottom: 3.5rem;
  }

  .header-eyebrow {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.25rem;
  }

  .eyebrow-line {
    width: 32px;
    height: 2px;
    background: var(--color-red);
  }

  .eyebrow-text {
    font-size: 0.75rem;
    font-weight: 700;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--color-red);
  }

  .header-row {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 2rem;
  }

  .services-title {
    font-size: clamp(2.5rem, 5vw, 4rem);
    font-weight: 800;
    line-height: 1.05;
    letter-spacing: -0.03em;
    color: var(--color-black);
    margin: 0;
  }

  .services-subtitle {
    font-size: 1.0625rem;
    color: var(--color-gray);
    line-height: 1.6;
    max-width: 360px;
    text-align: right;
    margin: 0;
  }

  /* ============================================
     GRID
     ============================================ */
  .services-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
  }

  /* ============================================
     CARD
     ============================================ */
  .service-card {
    opacity: 0;
    animation: card-in 0.6s var(--ease-out-expo) forwards;
    animation-delay: calc(var(--i) * 0.08s + 0.1s);
  }

  @keyframes card-in {
    from { opacity: 0; transform: translateY(24px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .card-link {
    display: flex;
    flex-direction: column;
    height: 100%;
    text-decoration: none;
    background: var(--color-white);
    border: 1px solid var(--color-mist);
    border-radius: var(--radius-xl);
    overflow: hidden;
    transition: all 0.45s var(--ease-out-expo);
  }

  .card-link:hover {
    transform: translateY(-6px);
    border-color: transparent;
    box-shadow:
      0 24px 48px -12px rgba(0,0,0,0.1),
      0 0 0 1px rgba(225,29,72,0.12);
  }

  /* ---- Image ---- */
  .card-image {
    position: relative;
    aspect-ratio: 6 / 5;
    overflow: hidden;
  }

  .card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.65s var(--ease-out-expo);
  }

  .card-link:hover .card-image img {
    transform: scale(1.06);
  }

  .card-image-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(180deg, transparent 40%, rgba(10,10,10,0.35) 100%);
    opacity: 0;
    transition: opacity 0.45s var(--ease-out-expo);
  }

  .card-link:hover .card-image-overlay {
    opacity: 1;
  }

  /* Price tag */
  .card-price-tag {
    position: absolute;
    top: 1rem;
    right: 1rem;
    padding: 0.375rem 0.75rem;
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-radius: var(--radius-full);
    font-size: 0.75rem;
    font-weight: 700;
    color: var(--color-black);
    letter-spacing: 0.01em;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    transition: all 0.35s var(--ease-out-expo);
  }

  .card-link:hover .card-price-tag {
    background: var(--color-red);
    color: var(--color-white);
  }

  /* ---- Content ---- */
  .card-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 1.5rem;
  }

  .card-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border-radius: var(--radius-md);
    background: rgba(225,29,72,0.06);
    color: var(--color-red);
    margin-bottom: 1rem;
    transition: all 0.35s var(--ease-out-expo);
  }

  .card-link:hover .card-icon {
    background: var(--color-red);
    color: var(--color-white);
  }

  .card-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--color-black);
    margin: 0 0 0.5rem;
    letter-spacing: -0.01em;
    transition: color 0.3s var(--ease-out-expo);
  }

  .card-link:hover .card-title {
    color: var(--color-red);
  }

  .card-desc {
    font-size: 0.9375rem;
    color: var(--color-gray);
    line-height: 1.6;
    margin: 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* ---- Footer ---- */
  .card-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: auto;
    padding-top: 1.25rem;
    border-top: 1px solid var(--color-mist);
  }

  .card-duration {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    font-size: 0.8125rem;
    font-weight: 600;
    color: var(--color-gray);
  }

  .card-arrow {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: var(--color-cloud);
    color: var(--color-charcoal);
    transition: all 0.35s var(--ease-out-expo);
  }

  .card-link:hover .card-arrow {
    background: var(--color-red);
    color: var(--color-white);
    transform: rotate(0deg);
  }

  /* ============================================
     CTA
     ============================================ */
  .services-cta {
    display: flex;
    justify-content: center;
    margin-top: 3rem;
  }

  /* ============================================
     RESPONSIVE
     ============================================ */
  @media (max-width: 1024px) {
    .services-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .header-row {
      flex-direction: column;
      align-items: flex-start;
    }

    .services-subtitle {
      text-align: left;
      max-width: 100%;
    }
  }

  @media (max-width: 640px) {
    .services-grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .services-title {
      font-size: 2.25rem;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .service-card {
      opacity: 1;
      animation: none;
    }

    .card-image img {
      transition: none;
    }
  }
</style>
