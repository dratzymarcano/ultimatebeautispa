---
import { Icon } from 'astro-icon/components';
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import CTA from '../../components/CTA.astro';
import { t } from '../../i18n/index';

const i = t('fr');

const categories = ['Tout', 'Coupes', 'Rasages', 'Massage', 'Tatouage', 'Intérieur', 'Coiffure'];

const galleryItems = [
  { src: 'https://images.unsplash.com/photo-1503951914875-452162b0f3f1?w=800&q=80', alt: 'Coupe de précision en cours', category: 'Coupes' },
  { src: 'https://images.unsplash.com/photo-1621605815971-fbc98d665033?w=800&q=80', alt: 'Rasage traditionnel au coupe-chou', category: 'Rasages' },
  { src: 'https://images.unsplash.com/photo-1544161515-4ab6ce6db874?w=800&q=80', alt: 'Séance de massothérapie relaxante', category: 'Massage' },
  { src: 'https://images.unsplash.com/photo-1598371839696-5c5bb00bdc28?w=800&q=80', alt: 'Artiste tatoueur au travail', category: 'Tatouage' },
  { src: 'https://images.unsplash.com/photo-1560066984-138dadb4c035?w=800&q=80', alt: 'Intérieur spa luxueux', category: 'Intérieur' },
  { src: 'https://images.unsplash.com/photo-1585747860715-2ba37e788b70?w=800&q=80', alt: 'Détails du salon de coiffure', category: 'Intérieur' },
  { src: 'https://images.unsplash.com/photo-1570172619644-dfd03ed5d881?w=800&q=80', alt: 'Application de soins de la peau', category: 'Coiffure' },
  { src: 'https://images.unsplash.com/photo-1522337360788-8b13dee7a37e?w=800&q=80', alt: 'Séance de coiffure', category: 'Coiffure' },
  { src: 'https://images.unsplash.com/photo-1493256338651-d82f7acb2b38?w=800&q=80', alt: 'Produits de grooming premium', category: 'Intérieur' },
  { src: 'https://images.unsplash.com/photo-1521590832167-7bcbfaa6381f?w=800&q=80', alt: 'Poste de barbier', category: 'Intérieur' },
  { src: 'https://images.unsplash.com/photo-1599351431202-1e0f0137899a?w=800&q=80', alt: 'Coupe dégradée fraîche', category: 'Coupes' },
  { src: 'https://images.unsplash.com/photo-1622288432450-277d0fef5ed6?w=800&q=80', alt: 'Coupe classique gentleman', category: 'Coupes' },
  { src: 'https://images.unsplash.com/photo-1517832606299-7ae9b720a186?w=800&q=80', alt: 'Entretien de barbe', category: 'Rasages' },
  { src: 'https://images.unsplash.com/photo-1600334129128-685c5582fd35?w=800&q=80', alt: 'Massage relaxant', category: 'Massage' },
  { src: 'https://images.unsplash.com/photo-1611501275019-9b5cda994e8d?w=800&q=80', alt: 'Design de tatouage personnalisé', category: 'Tatouage' },
  { src: 'https://images.unsplash.com/photo-1595476108010-b4d1f102b1b1?w=800&q=80', alt: 'Espace d\'attente luxueux', category: 'Intérieur' },
];
---

<Layout title={i.seo.galleryTitle} description={i.seo.galleryDesc} lang="fr">
  <Header slot="header" currentPath="/fr/gallery" lang="fr" />
  
  <!-- Page Hero -->
  <section class="relative py-24 overflow-hidden">
    <div class="absolute inset-0">
      <div 
        class="absolute inset-0 bg-cover bg-center"
        style="background-image: url('https://images.unsplash.com/photo-1560066984-138dadb4c035?w=1920&q=80')"
      ></div>
      <div class="absolute inset-0 bg-obsidian/90"></div>
    </div>
    
    <div class="container relative z-10 text-center">
      <div class="flex items-center justify-center gap-4 mb-4" data-animate="fade-in-up">
        <span class="ornament"></span>
        <span class="text-red text-sm uppercase tracking-[0.3em] font-medium">{i.gallery.eyebrow}</span>
        <span class="ornament"></span>
      </div>
      
      <h1 class="text-5xl sm:text-6xl font-display font-semibold text-white mb-6" data-animate="fade-in-up" style="animation-delay: 100ms">
        {i.gallery.pageHeroTitle}
      </h1>
      
      <p class="text-xl text-white/70 max-w-2xl mx-auto" data-animate="fade-in-up" style="animation-delay: 200ms">
        {i.gallery.pageHeroSubtitle}
      </p>
    </div>
  </section>
  
  <!-- Gallery Section -->
  <section class="section bg-snow">
    <div class="container">
      <div class="flex flex-wrap items-center justify-center gap-3 mb-12" data-animate="fade-in-up">
        {categories.map((category, index) => (
          <button 
            class={`px-6 py-2 rounded-full text-sm font-medium transition-all duration-300 ${
              index === 0 
                ? 'bg-red text-white' 
                : 'bg-mist text-charcoal hover:bg-red hover:text-white'
            }`}
            data-filter={category.toLowerCase()}
          >
            {category}
          </button>
        ))}
      </div>
      
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="gallery-grid">
        {galleryItems.map((item, index) => (
          <div 
            class="relative group img-zoom rounded-lg overflow-hidden aspect-square cursor-pointer"
            data-category={item.category.toLowerCase()}
            data-animate="scale-in"
            style={`animation-delay: ${(index % 8) * 50}ms`}
          >
            <img src={item.src} alt={item.alt} class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" loading="lazy" />
            <div class="absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-4">
              <span class="text-red text-xs uppercase tracking-wider">{item.category}</span>
              <p class="text-white text-sm mt-1">{item.alt}</p>
            </div>
            <button 
              class="absolute top-4 right-4 w-10 h-10 rounded-full glass flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 hover:bg-red/20"
              aria-label={`Voir ${item.alt} en plein écran`}
              data-lightbox={item.src}
              data-caption={item.alt}
            >
              <Icon name="lucide:maximize" class="w-5 h-5 text-white" />
            </button>
          </div>
        ))}
      </div>
    </div>
  </section>
  
  <!-- Lightbox -->
  <div id="lightbox" class="fixed inset-0 z-[200] bg-obsidian/95 hidden items-center justify-center p-4">
    <button id="lightbox-close" class="absolute top-6 right-6 w-12 h-12 rounded-full glass flex items-center justify-center text-white hover:text-red transition-colors" aria-label="Fermer">
      <Icon name="lucide:x" class="w-6 h-6" />
    </button>
    <div class="max-w-5xl max-h-[90vh]">
      <img id="lightbox-image" src="" alt="" class="max-w-full max-h-[80vh] object-contain rounded-lg" />
      <p id="lightbox-caption" class="text-center text-white/70 mt-4"></p>
    </div>
  </div>
  
  <CTA lang="fr" />
  
  <Footer slot="footer" lang="fr" />
</Layout>

<script>
  const filterButtons = document.querySelectorAll('[data-filter]');
  const galleryItems = document.querySelectorAll('[data-category]');
  
  filterButtons.forEach(button => {
    button.addEventListener('click', () => {
      const filter = button.getAttribute('data-filter');
      filterButtons.forEach(btn => {
        btn.classList.remove('bg-red', 'text-white');
        btn.classList.add('bg-mist', 'text-charcoal');
      });
      button.classList.remove('bg-mist', 'text-charcoal');
      button.classList.add('bg-red', 'text-white');
      
      galleryItems.forEach(item => {
        const category = item.getAttribute('data-category');
        if (filter === 'tout' || category === filter) {
          (item as HTMLElement).style.display = 'block';
        } else {
          (item as HTMLElement).style.display = 'none';
        }
      });
    });
  });
  
  const lightbox = document.getElementById('lightbox');
  const lightboxImage = document.getElementById('lightbox-image') as HTMLImageElement;
  const lightboxCaption = document.getElementById('lightbox-caption');
  const lightboxClose = document.getElementById('lightbox-close');
  const lightboxTriggers = document.querySelectorAll('[data-lightbox]');
  
  lightboxTriggers.forEach(trigger => {
    trigger.addEventListener('click', () => {
      const src = trigger.getAttribute('data-lightbox');
      const caption = trigger.getAttribute('data-caption');
      if (lightboxImage && src) lightboxImage.src = src;
      if (lightboxCaption && caption) lightboxCaption.textContent = caption;
      if (lightbox) { lightbox.classList.remove('hidden'); lightbox.classList.add('flex'); }
      document.body.style.overflow = 'hidden';
    });
  });
  
  function closeLightbox() {
    if (lightbox) { lightbox.classList.add('hidden'); lightbox.classList.remove('flex'); }
    document.body.style.overflow = '';
  }
  
  lightboxClose?.addEventListener('click', closeLightbox);
  lightbox?.addEventListener('click', (e) => { if (e.target === lightbox) closeLightbox(); });
  document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeLightbox(); });
</script>
